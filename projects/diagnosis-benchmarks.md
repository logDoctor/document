# Log Doctor: ì§„ë‹¨ í‘œì¤€ ê¸°ì¤€ (Diagnosis Benchmarks)

> ì§„ë‹¨ ê²°ê³¼ì˜ "ì¢‹ë‹¤/ë‚˜ì˜ë‹¤"ë¥¼ íŒë‹¨í•˜ëŠ” **5ê°€ì§€ í‘œì¤€ì **ê³¼ ì´ë¥¼ í•©ì‚°í•œ **Log Health Score** ì‚°ì¶œ ê¸°ì¤€.

---

## 1. ë¡œê·¸ ë ˆë²¨ ë¶„í¬ (Level Distribution) â€” ë°°ì  25ì 

> "í”„ë¡œë•ì…˜ì— Debug/Traceê°€ ëª‡ %ì¸ê°€?"

### ê¸°ì¤€ê°’

| ì§€í‘œ | ê±´ê°• âœ… | ì£¼ì˜ âš ï¸ | ìœ„í—˜ ğŸ”´ |
|:---|:---|:---|:---|
| DEBUG+TRACE ë¹„ìœ¨ | < 5% | 5~20% | > 20% |
| ERROR+CRITICAL ë¹„ìœ¨ | < 1% | 1~5% | > 5% |
| INFO ë¹„ìœ¨ | 60~80% | 40~60% | < 40% |

### ì ìˆ˜ ì‚°ì¶œ

```
debug_ratio = (DEBUG + TRACE ê±´ìˆ˜) / ì „ì²´ ë¡œê·¸

if debug_ratio < 5%:   level_score = 25
elif debug_ratio < 10%: level_score = 20
elif debug_ratio < 20%: level_score = 15
elif debug_ratio < 30%: level_score = 8
else:                   level_score = 0
```

### ê·¼ê±°

- í”„ë¡œë•ì…˜ì—ì„œ DEBUG ë¡œê·¸ëŠ” ê°œë°œ ì‹œ ë‚¨ê²¨ì§„ ì”ì¡´ ì½”ë“œ
- DEBUG ë¹„ìœ¨ì´ ë†’ì„ìˆ˜ë¡ LAW ë¹„ìš©ì´ ë¶ˆí•„ìš”í•˜ê²Œ ì¦ê°€
- **ì—…ê³„ ê¶Œì¥**: í”„ë¡œë•ì…˜ì€ INFO ì´ìƒë§Œ ì¶œë ¥ (12-Factor App)

---

## 2. ì—ëŸ¬ìœ¨ (Error Rate) â€” ë°°ì  25ì 

> "ì „ì²´ ìš”ì²­ ëŒ€ë¹„ 5xx ì‘ë‹µì´ ëª‡ %ì¸ê°€?"

### ê¸°ì¤€ê°’

| ì§€í‘œ | ê±´ê°• âœ… | ì£¼ì˜ âš ï¸ | ìœ„í—˜ ğŸ”´ |
|:---|:---|:---|:---|
| AppRequests 5xx ë¹„ìœ¨ | < 0.1% | 0.1~1% | > 1% |
| AppDependencies ì‹¤íŒ¨ìœ¨ | < 0.5% | 0.5~3% | > 3% |
| AppExceptions ë°œìƒë¥  (ì „ì²´ ëŒ€ë¹„) | < 0.5% | 0.5~2% | > 2% |

### ì ìˆ˜ ì‚°ì¶œ

```
request_error_rate = (ResultCode >= 500 ê±´ìˆ˜) / AppRequests ì „ì²´
dependency_fail_rate = (Success == false ê±´ìˆ˜) / AppDependencies ì „ì²´
exception_rate = AppExceptions ê±´ìˆ˜ / ì „ì²´ ë¡œê·¸

# ì„¸ ì§€í‘œì˜ ê°€ì¤‘ í‰ê· 
combined_error = request_error_rate * 0.5
              + dependency_fail_rate * 0.3
              + exception_rate * 0.2

if combined_error < 0.1%:  error_score = 25
elif combined_error < 0.5%: error_score = 20
elif combined_error < 1%:   error_score = 15
elif combined_error < 3%:   error_score = 8
else:                        error_score = 0
```

### ê·¼ê±°

| SLA ëª©í‘œ | í—ˆìš© ì—ëŸ¬ìœ¨ | ì›”ê°„ ë‹¤ìš´íƒ€ì„ |
|:---|:---|:---|
| 99.9% | 0.1% | 43ë¶„ |
| 99.5% | 0.5% | 3.6ì‹œê°„ |
| 99.0% | 1.0% | 7.3ì‹œê°„ |

- **Google SRE**: 99.9% SLA = ì—ëŸ¬ìœ¨ 0.1% ì´í•˜
- **AWS Well-Architected**: ì—ëŸ¬ìœ¨ 1% ì´ˆê³¼ ì‹œ ì¦‰ê° ëŒ€ì‘ í•„ìš”

---

## 3. ì‘ë‹µ ì‹œê°„ (Latency) â€” ë°°ì  20ì 

> "API ì‘ë‹µê³¼ ì™¸ë¶€ í˜¸ì¶œì´ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ëŠ”ê°€?"

### ê¸°ì¤€ê°’

| ì§€í‘œ | ê±´ê°• âœ… | ì£¼ì˜ âš ï¸ | ìœ„í—˜ ğŸ”´ |
|:---|:---|:---|:---|
| AppRequests P95 | < 1ì´ˆ | 1~5ì´ˆ | > 5ì´ˆ |
| AppDependencies (SQL) P95 | < 500ms | 500ms~3ì´ˆ | > 3ì´ˆ |
| AppDependencies (HTTP) P95 | < 2ì´ˆ | 2~10ì´ˆ | > 10ì´ˆ |

### ì ìˆ˜ ì‚°ì¶œ

```
# KQLë¡œ P95 ê³„ì‚°
request_p95 = percentile(AppRequests.DurationMs, 95)
sql_p95 = percentile(AppDependencies where Type=="SQL".DurationMs, 95)
http_p95 = percentile(AppDependencies where Type=="HTTP".DurationMs, 95)

# ê° ì§€í‘œ ì ìˆ˜ (7+7+6 = 20ì )
req_points  = 7 if request_p95 < 1000 else 5 if < 3000 else 2 if < 5000 else 0
sql_points  = 7 if sql_p95 < 500 else 5 if < 1500 else 2 if < 3000 else 0
http_points = 6 if http_p95 < 2000 else 4 if < 5000 else 1 if < 10000 else 0

latency_score = req_points + sql_points + http_points
```

### ê·¼ê±°

- **Google**: í˜ì´ì§€ ë¡œë“œ 3ì´ˆ ì´ˆê³¼ ì‹œ ì´íƒˆë¥  53% ì¦ê°€
- **Apdex ê¸°ì¤€**: T(ë§Œì¡±) < 1ì´ˆ, 4T(ë¶ˆë§Œ) > 4ì´ˆ
- **ëŠë¦° DB ì¿¼ë¦¬**: ì¥ì•  ì „ì¡° í˜„ìƒ â€” ì»¤ë„¥ì…˜ í’€ ê³ ê°ˆë¡œ ì´ì–´ì§

---

## 4. ë…¸ì´ì¦ˆ ë¹„ìœ¨ (Noise Rate) â€” ë°°ì  15ì 

> "ë¶ˆí•„ìš”í•˜ê²Œ ë°˜ë³µë˜ëŠ” ë¡œê·¸ê°€ ëª‡ %ì¸ê°€?"

### ê¸°ì¤€ê°’

| ì§€í‘œ | ê±´ê°• âœ… | ì£¼ì˜ âš ï¸ | ìœ„í—˜ ğŸ”´ |
|:---|:---|:---|:---|
| ë™ì¼ ë©”ì‹œì§€ 50ê±´+ ë°˜ë³µ ë¹„ìœ¨ | < 10% | 10~30% | > 30% |
| Health check / í—¬ìŠ¤ì²´í¬ ë¡œê·¸ ë¹„ìœ¨ | < 5% | 5~15% | > 15% |
| ë‹¨ì¼ í…Œì´ë¸” ì§‘ì¤‘ë¥  (1ê°œ í…Œì´ë¸” > 70%) | âŒ | â€” | âœ… |

### ì ìˆ˜ ì‚°ì¶œ

```
# ë™ì¼ ë©”ì‹œì§€ ë°˜ë³µ íƒì§€ (ì• 100ì ê¸°ì¤€)
repeated_logs = count where same Message(first 100 chars) appears 50+ times
noise_ratio = repeated_logs / ì „ì²´ ë¡œê·¸

if noise_ratio < 10%:  noise_score = 15
elif noise_ratio < 20%: noise_score = 10
elif noise_ratio < 30%: noise_score = 5
else:                    noise_score = 0
```

### ëŒ€í‘œì  ë…¸ì´ì¦ˆ íŒ¨í„´

| íŒ¨í„´ | ì˜ˆì‹œ | ì›ì¸ |
|:---|:---|:---|
| Health Check ë°˜ë³µ | `"GET /health 200"` Ã— 10,000ê±´ | ë¡œë“œë°¸ëŸ°ì„œ í”„ë¡œë¸Œ |
| í•˜íŠ¸ë¹„íŠ¸ ë¡œê·¸ | `"Connection alive"` Ã— 5,000ê±´ | ë¯¸ë“¤ì›¨ì–´ ìë™ ë¡œê¹… |
| ë¹ˆ ìš”ì²­ ë¡œê·¸ | `"GET /favicon.ico 404"` Ã— 3,000ê±´ | ë¸Œë¼ìš°ì € ìë™ ìš”ì²­ |
| ë°˜ë³µ ê²½ê³  | `"Cache miss for key: xxx"` Ã— 8,000ê±´ | ìºì‹œ ë¯¸ìŠ¤ ê³¼ë„ ë¡œê¹… |

---

## 5. ë¹„ìš© íš¨ìœ¨ (Cost Efficiency) â€” ë°°ì  15ì 

> "ì „ì²´ ë¡œê·¸ ì¤‘ ì‹¤ì œë¡œ ê°€ì¹˜ ìˆëŠ” ë¡œê·¸ê°€ ì ì ˆí•œ ë¹„ìœ¨ì¸ê°€?"

### ê¸°ì¤€ê°’

| Retain ë“±ê¸‰ | ì˜ë¯¸ | ê±´ê°•í•œ ë¹„ìœ¨ |
|:---|:---|:---|
| **Class A** (high) | ì¥ê¸° ë³´ì¡´ í•„ìˆ˜ (ì—ëŸ¬, ì˜ˆì™¸, ë³´ì•ˆ) | 5~15% |
| **Class B** (medium) | 14ì¼ ë³´ì¡´ (ì¼ë°˜ ìš´ì˜ ë¡œê·¸) | 40~60% |
| **Class C** (low+noise) | 7ì¼ ì´ë‚´ ì‚­ì œ ê°€ëŠ¥ | 30~50% |

### ì ìˆ˜ ì‚°ì¶œ

```
class_c_ratio = Class C ê±´ìˆ˜ / ì „ì²´ ë¡œê·¸

# Class Cê°€ ì ì ˆí•˜ë©´ ë§Œì , ë„ˆë¬´ ë†’ìœ¼ë©´ ë¹„ìš© ë‚­ë¹„
if class_c_ratio in 30~50%:  cost_score = 15   # ì´ìƒì 
elif class_c_ratio in 20~30%: cost_score = 12   # ì•½ê°„ ë³´ìˆ˜ì  (ê³¼ë³´ì¡´)
elif class_c_ratio in 50~60%: cost_score = 10   # ì•½ê°„ ë‚­ë¹„
elif class_c_ratio > 60%:     cost_score = 3    # ì‹¬ê°í•œ ë¹„ìš© ë‚­ë¹„
elif class_c_ratio < 20%:     cost_score = 8    # ê³¼ë„í•œ ë³´ì¡´ (ëª¨ë“  ë¡œê·¸ë¥¼ ì¤‘ìš”í•˜ê²Œ ì·¨ê¸‰)
```

### ë¹„ìš© ì¶”ì • ê³µì‹

```
ì˜ˆìƒ ì ˆê°ì•¡ = noise_count Ã— í‰ê· _ë¡œê·¸_í¬ê¸°(KB) Ã— 30ì¼ Ã— LAW_GBë‹¹_ê°€ê²©

ì˜ˆì‹œ:
  ë…¸ì´ì¦ˆ 5,000ê±´/ì‹œê°„ Ã— 0.5KB Ã— 24h Ã— 30ì¼ = ì•½ 1.8GB/ì›”
  LAW ë¹„ìš© $2.76/GB â†’ ì›” ì•½ $5.0 ì ˆê°
  (ê·œëª¨ê°€ í´ìˆ˜ë¡ ì ˆê°ì•¡ ê¸‰ì¦)
```

---

## ì¢…í•©: Log Health Score (100ì )

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Log Health Score ì‚°ì¶œ                      â”‚
â”‚                                                           â”‚
â”‚  â‘  ë ˆë²¨ ë¶„í¬     25ì   â”€â”€â”€ Debug ë¹„ìœ¨ ê¸°ë°˜                â”‚
â”‚  â‘¡ ì—ëŸ¬ìœ¨        25ì   â”€â”€â”€ 5xx + ì˜ì¡´ì„± ì‹¤íŒ¨ + ì˜ˆì™¸       â”‚
â”‚  â‘¢ ì‘ë‹µ ì‹œê°„     20ì   â”€â”€â”€ Request/SQL/HTTP P95          â”‚
â”‚  â‘£ ë…¸ì´ì¦ˆ ë¹„ìœ¨   15ì   â”€â”€â”€ ë°˜ë³µ ë©”ì‹œì§€ ë¹„ìœ¨               â”‚
â”‚  â‘¤ ë¹„ìš© íš¨ìœ¨     15ì   â”€â”€â”€ Class C ë¹„ìœ¨ ì ì •ì„±            â”‚
â”‚                  â”€â”€â”€â”€â”€                                    â”‚
â”‚  í•©ê³„           100ì                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë“±ê¸‰ ê¸°ì¤€

| ì ìˆ˜ | ë“±ê¸‰ | ì˜ë¯¸ | Teams í‘œì‹œ |
|:---:|:---:|:---|:---|
| 90~100 | **A** | ë§¤ìš° ê±´ê°• â€” í˜„ ìƒíƒœ ìœ ì§€ | ğŸŸ¢ Excellent |
| 75~89 | **B** | ì–‘í˜¸ â€” ì†Œì†Œí•œ ê°œì„  ê°€ëŠ¥ | ğŸ”µ Good |
| 60~74 | **C** | ì£¼ì˜ í•„ìš” â€” ê°œì„  ê¶Œê³  | ğŸŸ¡ Fair |
| 40~59 | **D** | ë¬¸ì œ ìˆìŒ â€” ì¡°ì¹˜ í•„ìš” | ğŸŸ  Poor |
| 0~39 | **F** | ì‹¬ê° â€” ì¦‰ê° ëŒ€ì‘ í•„ìš” | ğŸ”´ Critical |

### ë¦¬í¬íŠ¸ ì˜ˆì‹œ

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ğŸ“Š Log Health Score: 72/100 (C â€” ì£¼ì˜ í•„ìš”)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  â‘  ë ˆë²¨ ë¶„í¬     15/25  âš ï¸  DEBUG 12% â†’ ë¡œê·¸ ë ˆë²¨ ìƒí–¥ í•„ìš”
  â‘¡ ì—ëŸ¬ìœ¨        20/25  âœ…  ì—ëŸ¬ìœ¨ 0.3% (ì–‘í˜¸)
  â‘¢ ì‘ë‹µ ì‹œê°„     17/20  âœ…  P95 1.2ì´ˆ (ì–‘í˜¸)
  â‘£ ë…¸ì´ì¦ˆ ë¹„ìœ¨   10/15  âš ï¸  ë…¸ì´ì¦ˆ 18% â†’ í•„í„°ë§ ê¶Œê³ 
  â‘¤ ë¹„ìš© íš¨ìœ¨     10/15  âœ…  Class C 38% (ì ì •)

  ğŸ“Œ ì£¼ìš” ê¶Œê³ ì‚¬í•­:
  1. order-service, user-serviceì˜ ë¡œê·¸ ë ˆë²¨ì„ INFOë¡œ ìƒí–¥
  2. Health check ë¡œê·¸ í•„í„°ë§ ì ìš© ì‹œ ì›” ~$5.0 ì ˆê° ê°€ëŠ¥
  3. payment-service SQL P95 2.3ì´ˆ â†’ ì¿¼ë¦¬ ìµœì í™” ê²€í† 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```
